[uwsgi]
thunder-lock = true
uid = nginx
gid = nginx
chown-socket = nginx:nginx
chmod-socket = 664
socket = 0.0.0.0:5001
pidfile = /run/uwsgi/%n.pid
## -------------------------------------------------------------------------------------------
### serving static files
## simple case, for documentation only (will fall back to app when file not found)
static-map = /static=/home/ubuntu/webapp/static
## -------------------------------------------------------------------------------------------
static-expires = /* 7776000
offload-threads = %k
## -------------------------------------------------------------------------------------------
### better static files handler
## If the path starts with /static/ go to the route-label "static"
route-if = startswith:${PATH_INFO};/static/ goto:static
mimefile = /etc/mime.types
route-label = static
## Remove /static/ from ${PATH_INFO} to find the file on the filesystem
route = ^/static/(.*) rewrite:$1
## If the file exists, serve it
route-if = isfile:/home/ubuntu/webapp/static/${PATH_INFO} static:/home/ubuntu/webapp/static/${PATH_INFO}
## If the file is not found, serve a 404
route-run = addheader:Cache-Control: no-cache
route = .* return:404
## Close the "static" route label
route = .* last:
## -------------------------------------------------------------------------------------------
logger = file:/var/log/uwsgi/%n.log
